(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52754,e=>{"use strict";let t=(0,e.i(75254).default)("wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);e.s(["Wallet",()=>t],52754)},39312,e=>{"use strict";let t=(0,e.i(75254).default)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);e.s(["Zap",()=>t],39312)},51689,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(18566),r=e.i(75254);let l=(0,r.default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var i=e.i(30699),d=e.i(37727),n=e.i(39312),c=e.i(52754);let x=(0,r.default)("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]]);var m=e.i(9165),o=e.i(71664);let u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function p(){let e=(0,a.useRouter)(),[r,p]=(0,s.useState)("Herohalli"),[h,g]=(0,s.useState)(null),[v,f]=(0,s.useState)(!0),[j,N]=(0,s.useState)(""),[b,w]=(0,s.useState)(!1),[y,k]=(0,s.useState)([]),[C,I]=(0,s.useState)(!1),[S,A]=(0,s.useState)({studentId:"",amount:500,reason:"",description:"",usedInMonth:""}),[M,D]=(0,s.useState)(!1),[U,R]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=localStorage.getItem("skf_user"),t=localStorage.getItem("skf_login_time");e&&t&&(Date.now(),parseInt(t))},[e]);let E=(0,s.useCallback)(async()=>{f(!0),N("");try{let e=await (0,m.getReferralCredits)(r);g(e)}catch(e){N(e instanceof Error?e.message:"Failed to load data")}finally{f(!1)}},[r]);(0,s.useEffect)(()=>{E()},[E]);let L=async()=>{w(!0),I(!0);try{let e=await (0,m.getStudents)(r,new Date().getMonth());k(e.filter(e=>"Active"===e.status))}catch{alert("Failed to load students")}finally{I(!1)}},T=async()=>{if(!S.studentId)return void alert("Please select a student");if(S.amount<=0)return void alert("Please enter a valid amount");D(!0);try{let e=""!==S.usedInMonth?parseInt(S.usedInMonth):void 0,t=void 0!==e?new Date().toISOString():void 0;await (0,m.addReferralCredit)(r,S.studentId,S.amount,S.reason,S.description,e,t),w(!1),A({studentId:"",amount:500,reason:"",description:"",usedInMonth:""}),E()}catch(e){alert(e instanceof Error?e.message:"Failed to add credit")}finally{D(!1)}},H=(0,s.useMemo)(()=>{if(!h)return{total:0,totalAmount:0,active:0,activeAmount:0,redeemed:0,redeemedAmount:0};let e=h.credits.length,t=h.credits.reduce((e,t)=>e+t.amount,0),s=h.credits.filter(e=>!e.isUsed).length,a=h.credits.filter(e=>!e.isUsed).reduce((e,t)=>e+t.amount,0);return{total:e,totalAmount:t,active:s,activeAmount:a,redeemed:h.credits.filter(e=>e.isUsed).length,redeemedAmount:h.credits.filter(e=>e.isUsed).reduce((e,t)=>e+t.amount,0)}},[h]);return(0,t.jsxs)("div",{className:"min-h-screen",style:{background:"var(--bg-deep)"},children:[(0,t.jsx)(o.default,{title:"REFERRAL CREDITS",showBack:!0,rightContent:null}),(0,t.jsxs)("main",{className:"max-w-2xl mx-auto p-4 pt-24",children:[(0,t.jsxs)("div",{className:"flex p-1 bg-black/20 rounded-xl w-full max-w-md mx-auto border border-white/5 mb-6",children:[(0,t.jsx)("button",{onClick:()=>p("Herohalli"),className:`flex-1 py-2 rounded-lg text-sm font-[family-name:var(--font-space)] tracking-wider transition-all duration-300 ${"Herohalli"===r?"bg-red-600/90 text-white shadow-lg shadow-red-900/20 border border-white/10":"text-[var(--text-muted)] hover:text-white"}`,children:"HEROHALLI"}),(0,t.jsx)("button",{onClick:()=>p("MPSC"),className:`flex-1 py-2 rounded-lg text-sm font-[family-name:var(--font-space)] tracking-wider transition-all duration-300 ${"MPSC"===r?"bg-blue-600/90 text-white shadow-lg shadow-blue-900/20 border border-white/10":"text-[var(--text-muted)] hover:text-white"}`,children:"MP SPORTS CLUB"})]}),v&&(0,t.jsxs)("div",{className:"text-center py-16",children:[(0,t.jsx)("div",{className:"spinner mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-[var(--text-muted)] text-sm",children:"Loading referral credits..."})]}),j&&(0,t.jsxs)("div",{className:"text-center py-16",children:[(0,t.jsx)("p",{className:"text-red-400 mb-4 text-sm",children:j}),(0,t.jsx)("button",{onClick:E,className:"btn-primary text-sm",children:"Retry"})]}),!v&&!j&&h&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 mb-6 animate-fade-in",children:[(0,t.jsxs)("div",{className:"glass-card p-4 relative overflow-hidden",style:{borderColor:"rgba(59, 130, 246, 0.25)"},children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 p-2 opacity-10",children:(0,t.jsx)(x,{className:"w-12 h-12 text-blue-400"})}),(0,t.jsxs)("p",{className:"text-[var(--text-muted)] text-[10px] uppercase tracking-wider mb-1 flex items-center gap-1",children:[(0,t.jsx)(x,{className:"w-3 h-3"})," Total Issued"]}),(0,t.jsxs)("p",{className:"font-[family-name:var(--font-space)] text-lg sm:text-xl text-blue-400",children:["₹",H.totalAmount.toLocaleString()]}),(0,t.jsxs)("p",{className:"text-[10px] text-[var(--text-muted)] mt-1 opacity-70",children:[H.total," credits total"]})]}),(0,t.jsxs)("div",{className:"glass-card p-4 relative overflow-hidden",style:{borderColor:"rgba(34, 197, 94, 0.25)"},children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 p-2 opacity-10",children:(0,t.jsx)(n.Zap,{className:"w-12 h-12 text-green-400"})}),(0,t.jsxs)("p",{className:"text-[var(--text-muted)] text-[10px] uppercase tracking-wider mb-1 flex items-center gap-1",children:[(0,t.jsx)(n.Zap,{className:"w-3 h-3"})," Active"]}),(0,t.jsxs)("p",{className:"font-[family-name:var(--font-space)] text-lg sm:text-xl text-green-400",children:["₹",H.activeAmount.toLocaleString()]}),(0,t.jsxs)("p",{className:"text-[10px] text-[var(--text-muted)] mt-1 opacity-70",children:[H.active," available to use"]})]}),(0,t.jsxs)("div",{className:"glass-card p-4 relative overflow-hidden",style:{borderColor:"rgba(245, 158, 11, 0.25)"},children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 p-2 opacity-10",children:(0,t.jsx)(c.Wallet,{className:"w-12 h-12 text-amber-400"})}),(0,t.jsxs)("p",{className:"text-[var(--text-muted)] text-[10px] uppercase tracking-wider mb-1 flex items-center gap-1",children:[(0,t.jsx)(c.Wallet,{className:"w-3 h-3"})," Redeemed"]}),(0,t.jsxs)("p",{className:"font-[family-name:var(--font-space)] text-lg sm:text-xl text-amber-400",children:["₹",H.redeemedAmount.toLocaleString()]}),(0,t.jsxs)("p",{className:"text-[10px] text-[var(--text-muted)] mt-1 opacity-70",children:[H.redeemed," credits used"]})]})]}),(0,t.jsxs)("div",{className:"animate-fade-in",style:{animationDelay:"100ms"},children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)("p",{className:"text-[var(--text-muted)] text-[10px] uppercase tracking-wider",children:"All Credits"}),(0,t.jsxs)("button",{onClick:L,className:"px-4 py-2 text-xs sm:text-sm rounded-lg border border-green-600/50 text-green-400 hover:bg-green-600 hover:text-white transition-all duration-200 font-medium tracking-wide flex items-center gap-1",children:[(0,t.jsx)(l,{className:"w-4 h-4"})," Add Credit"]})]}),(0,t.jsx)("div",{className:"space-y-2",children:0===h.credits.length?(0,t.jsx)("div",{className:"glass-card p-6 text-center text-[var(--text-muted)] text-sm",children:"No referral credits yet. Add one when a parent refers a new student."}):h.credits.sort((e,t)=>e.isUsed!==t.isUsed?e.isUsed?1:-1:t.id.localeCompare(e.id)).map(e=>(0,t.jsx)("div",{onClick:()=>R(e),className:`glass-card p-4 transition-all duration-200 cursor-pointer group ${e.isUsed?"opacity-60 hover:opacity-80 border-white/5":"hover:border-green-400/30 border-white/10"}`,children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("p",{className:"font-[family-name:var(--font-space)] tracking-wide truncate text-sm text-white group-hover:text-green-200 transition-colors",children:e.studentName}),(0,t.jsx)("span",{className:`text-[10px] px-2 py-0.5 border rounded-full ${e.isUsed?"bg-amber-600/10 text-amber-500 border-amber-600/30":"bg-green-600/20 text-green-400 border-green-600/50"}`,children:e.isUsed?"Redeemed":"Active"})]}),(0,t.jsxs)("p",{className:"text-[var(--text-muted)] text-xs flex items-center gap-2",children:[(0,t.jsxs)("span",{children:["Ref: ",e.reason]}),(0,t.jsx)("span",{className:"opacity-50",children:"•"}),(0,t.jsx)("span",{children:e.dateEarned||"No Date"})]})]}),(0,t.jsxs)("div",{className:"ml-4 text-right",children:[(0,t.jsxs)("p",{className:`font-[family-name:var(--font-space)] text-lg ${e.isUsed?"text-[var(--text-muted)]":"text-green-400"}`,children:["₹",e.amount.toLocaleString()]}),e.isUsed&&null!==e.usedInMonth&&(0,t.jsxs)("p",{className:"text-[10px] text-amber-400/80 mt-0.5",children:["Used in ",u[e.usedInMonth]]})]})]})},e.id))})]})]})]}),b&&(0,t.jsx)("div",{className:"glass-modal-overlay",onClick:e=>e.target===e.currentTarget&&w(!1),children:(0,t.jsx)("div",{className:"glass-modal !max-w-md",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsx)("h2",{className:"font-[family-name:var(--font-space)] text-xl tracking-wider",children:"ADD CREDIT"}),(0,t.jsx)("button",{onClick:()=>w(!1),className:"text-[var(--text-muted)] hover:text-white transition-colors",children:(0,t.jsx)(d.X,{className:"w-5 h-5"})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-[var(--text-muted)] text-xs uppercase tracking-wider block mb-2 font-medium",children:"Referred From *"}),C?(0,t.jsx)("p",{className:"text-[var(--text-muted)] text-sm",children:"Loading students..."}):(0,t.jsxs)("select",{value:S.studentId,onChange:e=>A({...S,studentId:e.target.value}),className:"input-field",children:[(0,t.jsx)("option",{value:"",children:"Select student..."}),y.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name," (",e.id,")"]},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-[var(--text-muted)] text-xs uppercase tracking-wider block mb-2 font-medium",children:"Credit Amount (₹) *"}),(0,t.jsx)("input",{type:"number",value:S.amount,onChange:e=>A({...S,amount:parseInt(e.target.value)||500}),className:"input-field"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-[var(--text-muted)] text-xs uppercase tracking-wider block mb-2 font-medium",children:"Referred To (New Student) *"}),C?(0,t.jsx)("p",{className:"text-[var(--text-muted)] text-sm",children:"Loading students..."}):(0,t.jsxs)("select",{value:y.find(e=>S.reason.includes(e.id))?.id||"",onChange:e=>{let t=y.find(t=>t.id===e.target.value);t?A({...S,reason:`${t.name} (${t.id})`}):A({...S,reason:""})},className:"input-field",children:[(0,t.jsx)("option",{value:"",children:"Select new student..."}),y.filter(e=>e.id!==S.studentId).map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name," (",e.id,")"]},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-[var(--text-muted)] text-xs uppercase tracking-wider block mb-2 font-medium",children:"Used In Month (Optional)"}),(0,t.jsxs)("select",{value:S.usedInMonth,onChange:e=>A({...S,usedInMonth:e.target.value}),className:"input-field",children:[(0,t.jsx)("option",{value:"",children:"Not Used Yet"}),u.map((e,s)=>(0,t.jsxs)("option",{value:s,children:[e," 2026"]},e))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-[var(--text-muted)] text-xs uppercase tracking-wider block mb-2 font-medium",children:"Description"}),(0,t.jsx)("textarea",{value:S.description,onChange:e=>A({...S,description:e.target.value}),placeholder:"Additional notes...",rows:3,className:"input-field resize-none"})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,t.jsx)("button",{onClick:()=>w(!1),className:"btn-ghost flex-1 font-[family-name:var(--font-space)] tracking-wider text-sm",children:"CANCEL"}),(0,t.jsx)("button",{onClick:T,disabled:M||!S.studentId,className:"flex-1 py-3 bg-green-600 text-white rounded-lg font-[family-name:var(--font-space)] tracking-wider text-sm hover:bg-green-500 transition-colors disabled:opacity-50",children:M?"ADDING...":(0,t.jsx)("span",{className:"flex items-center justify-center gap-2",children:"ADD CREDIT"})})]})]})})}),U&&(0,t.jsx)("div",{className:"glass-modal-overlay",onClick:e=>e.target===e.currentTarget&&R(null),children:(0,t.jsx)("div",{className:"glass-modal !max-w-md",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("h2",{className:"font-[family-name:var(--font-space)] text-xl tracking-wider flex items-center gap-2",children:[(0,t.jsx)(i.Gift,{className:"w-5 h-5 text-purple-400"})," CREDIT DETAILS"]}),(0,t.jsx)("button",{onClick:()=>R(null),className:"text-[var(--text-muted)] hover:text-white transition-colors",children:(0,t.jsx)(d.X,{className:"w-5 h-5"})})]}),(0,t.jsx)("div",{className:"flex justify-center mb-5",children:(0,t.jsx)("span",{className:`text-xs px-4 py-1.5 border rounded-full font-medium tracking-wide ${U.isUsed?"bg-amber-600/10 text-amber-500 border-amber-600/30":"bg-green-600/20 text-green-400 border-green-600/50"}`,children:U.isUsed?"✓ Redeemed":"● Active"})}),(0,t.jsx)("div",{className:"text-center mb-6",children:(0,t.jsxs)("p",{className:`font-[family-name:var(--font-space)] text-3xl ${U.isUsed?"text-[var(--text-muted)]":"text-green-400"}`,children:["₹",U.amount.toLocaleString()]})}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"glass-surface p-3 rounded-lg",children:[(0,t.jsx)("p",{className:"text-[var(--text-muted)] text-[10px] uppercase tracking-wider mb-0.5",children:"Student"}),(0,t.jsx)("p",{className:"text-white text-sm font-medium",children:U.studentName}),(0,t.jsxs)("p",{className:"text-[var(--text-muted)] text-xs",children:["ID: ",U.studentId]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"glass-surface p-3 rounded-lg",children:[(0,t.jsx)("p",{className:"text-[var(--text-muted)] text-[10px] uppercase tracking-wider mb-0.5",children:"Credit ID"}),(0,t.jsx)("p",{className:"text-white text-sm font-mono truncate",children:U.id})]}),(0,t.jsxs)("div",{className:"glass-surface p-3 rounded-lg",children:[(0,t.jsx)("p",{className:"text-[var(--text-muted)] text-[10px] uppercase tracking-wider mb-0.5",children:"Reason"}),(0,t.jsx)("p",{className:"text-white text-sm line-clamp-1",children:U.reason})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"glass-surface p-3 rounded-lg",children:[(0,t.jsx)("p",{className:"text-[var(--text-muted)] text-[10px] uppercase tracking-wider mb-0.5",children:"Date Earned"}),(0,t.jsx)("p",{className:"text-white text-sm",children:U.dateEarned})]}),U.isUsed&&U.usedDate&&(0,t.jsxs)("div",{className:"glass-surface p-3 rounded-lg",children:[(0,t.jsx)("p",{className:"text-[var(--text-muted)] text-[10px] uppercase tracking-wider mb-0.5",children:"Redeemed On"}),(0,t.jsx)("p",{className:"text-amber-400 text-sm",children:U.usedDate.split("T")[0]})]}),U.isUsed&&null!==U.usedInMonth&&(0,t.jsxs)("div",{className:"glass-surface p-3 rounded-lg",children:[(0,t.jsx)("p",{className:"text-[var(--text-muted)] text-[10px] uppercase tracking-wider mb-0.5",children:"Applied For"}),(0,t.jsx)("p",{className:"text-amber-400 text-sm",children:u[U.usedInMonth]||"Unknown"})]})]}),U.description&&(0,t.jsxs)("div",{className:"glass-surface p-3 rounded-lg",children:[(0,t.jsx)("p",{className:"text-[var(--text-muted)] text-[10px] uppercase tracking-wider mb-0.5",children:"Description"}),(0,t.jsx)("p",{className:"text-white text-sm whitespace-pre-wrap",children:U.description})]})]}),(0,t.jsx)("button",{onClick:()=>R(null),className:"w-full mt-6 btn-ghost font-[family-name:var(--font-space)] tracking-wider text-sm",children:"CLOSE"})]})})})]})}e.s(["default",()=>p],51689)}]);